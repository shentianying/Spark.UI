{"remainingRequest":"D:\\Projects\\spark\\Spark.UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Projects\\spark\\Spark.UI\\src\\views\\lcgl\\flowDesign\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Projects\\spark\\Spark.UI\\src\\views\\lcgl\\flowDesign\\index.vue","mtime":1628919934786},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getFlowList, putFlowPrev, putFlowNext, putFlowBottom, putFlowTop } from '@/api/xtgl/flow'\r\nimport { getFormList } from '@/api/xtgl/form'\r\nimport FlowAdd from './flowAdd'\r\nimport AddFlowNode from './component/addFlowNode'\r\nimport ConditionAdd from './conditionAdd'\r\nimport Flow from './component/flow'\r\nexport default {\r\n  name: 'FlowDesign',\r\n  components: {\r\n    FlowAdd,\r\n    AddFlowNode,\r\n    Flow,\r\n    ConditionAdd\r\n  },\r\n  data() {\r\n    return {\r\n      formList: null,\r\n      list: [],\r\n      dropDownData: {}, // 所有的下拉初始化数据\r\n      listLoading: false,\r\n      dialogTableVisible: false,\r\n      dialogTitle: '流程信息',\r\n      comName: 'flowAdd',\r\n      isCopy: false,\r\n\r\n      currentRow: null,\r\n      currentForm: null, // 当前选中表单的对象\r\n      buttonLoading: false,\r\n      searchText: '',\r\n\r\n      currentIndex: null\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchData()\r\n  },\r\n  methods: {\r\n    fetchData() {\r\n      getFormList({ needCheckup: true }).then(response => {\r\n        const { data } = response\r\n        this.formList = data\r\n      }).catch(() => { })\r\n    },\r\n    getFlow() {\r\n      var postData = {}\r\n      postData.name = this.searchText\r\n      postData.formId = this.currentForm.id\r\n      this.listLoading = true\r\n      getFlowList(postData).then(response => {\r\n        const { data, roleList, roleType, options, flowNodeMode, formfield, fieldType, dictionary, organization, formState, grade } = response\r\n        this.dropDownData.flowList = data\r\n        this.dropDownData.roleList = roleList\r\n        this.dropDownData.roleTypeList = roleType\r\n        // this.dropDownData.flowNodeTypeList = flowNodeType\r\n        this.dropDownData.options = options // 操作类型\r\n        this.dropDownData.flowNodeModeList = flowNodeMode\r\n        this.dropDownData.formfieldList = formfield\r\n        this.dropDownData.fieldTypeList = fieldType\r\n        this.dropDownData.dictionary = dictionary\r\n        this.dropDownData.organization = organization\r\n        this.dropDownData.formStateList = formState\r\n        this.dropDownData.gradeList = grade\r\n        this.list = data\r\n        this.listLoading = false\r\n      }).catch(() => { this.listLoading = false })\r\n    },\r\n    handleAdd() {\r\n      this.currentRow = null\r\n      this.comName = 'FlowAdd'\r\n      this.dialogTableVisible = true\r\n    },\r\n    dialogClose() {\r\n      this.dialogTableVisible = false\r\n      this.getFlow()\r\n    },\r\n    updateFlow(row) {\r\n      this.currentRow = row\r\n      this.isCopy = false\r\n      this.comName = 'FlowAdd'\r\n      this.dialogTableVisible = true\r\n    },\r\n    formClick(item, index) {\r\n      this.currentForm = item\r\n      this.currentIndex = index // 记录当前选中项的index\r\n      this.getFlow()\r\n    },\r\n    prev(row) {\r\n      putFlowPrev(row).then(response => {\r\n        this.$message(response.message)\r\n        this.getFlow()\r\n      }).catch(() => {})\r\n    },\r\n    next(row) {\r\n      putFlowNext(row).then(response => {\r\n        this.$message(response.message)\r\n        this.getFlow()\r\n      }).catch(() => {})\r\n    },\r\n    top(row) {\r\n      putFlowTop(row).then(response => {\r\n        this.$message(response.message)\r\n        this.getFlow()\r\n      }).catch(() => {})\r\n    },\r\n    bottom(row) {\r\n      putFlowBottom(row).then(response => {\r\n        this.$message(response.message)\r\n        this.getFlow()\r\n      }).catch(() => {})\r\n    },\r\n    addFlowCondition(row) {\r\n      this.dialogTitle = '添加条件 - ' + row.name\r\n      this.currentRow = row\r\n      this.comName = 'conditionAdd'\r\n      this.dialogTableVisible = true\r\n    },\r\n    copyFlow(row) {\r\n      this.dialogTitle = '复制流程'\r\n      this.currentRow = row\r\n      this.comName = 'FlowAdd'\r\n      this.isCopy = true\r\n      this.dialogTableVisible = true\r\n      // this.$confirm('是否确定复制', '提示', {\r\n      //   type: 'warning'\r\n      // }).then(() => {\r\n      //   copyFlow({ id: row.id }).then(response => {\r\n      //     const { message } = response\r\n      //     this.$message(message)\r\n      //     this.getFlow()\r\n      //   })\r\n      // }).catch(() => {})\r\n    },\r\n    formateCondition(condition) {\r\n      if (condition) { return condition.replace(/(并且|或者)/g, '<br>$1').split('<br>') } else { return [] }\r\n    }\r\n  }\r\n\r\n}\r\n",null]}