{"remainingRequest":"D:\\Projects\\spark\\Spark.UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Projects\\spark\\Spark.UI\\src\\views\\ywgl\\SocialResource\\edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Projects\\spark\\Spark.UI\\src\\views\\ywgl\\SocialResource\\edit.vue","mtime":1634276967080},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Projects\\spark\\Spark.UI\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport UpFile from '@/components/UpLoad/UpFile'\r\n// import { validate } from '@/utils/validate'\r\nimport { getSocialResourceById, addSocialResource, putSocialResource } from '@/api/ywgl/socialResource.js'\r\n\r\nexport default {\r\n  name: 'SocialResourceEdit',\r\n  components: {\r\n    UpFile\r\n  },\r\n  data() {\r\n    return {\r\n      size: 'mini',\r\n      inputPlaceholder: '请输入',\r\n      selectPlaceholder: '请选择',\r\n      firstForm: {\r\n        companyId: this.$store.state.user.selectOrgId,\r\n        orgId: this.$store.state.user.selectOrgId, // 添加人员的orgId\r\n        id: 0, // 新增为0\r\n        name: '', // 姓名\r\n        sex: '',\r\n        birthYear: null,\r\n        companyTel: '',\r\n        company: '',\r\n        companyType: '',\r\n        position: '',\r\n        companyAddress: '',\r\n        homeAddress: '',\r\n        homeTel: '',\r\n        email: '',\r\n        qq: '',\r\n        interest: '',\r\n        study: '',\r\n        work: '',\r\n        resources: '',\r\n        inUse: true,\r\n        remark: '', // 备注\r\n        fileList: [] // 附件\r\n      },\r\n      firstRules: {\r\n        name: [\r\n          { required: true, message: '请输入姓名' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    'firstForm.birthYear'(val) {\r\n      this.firstForm.birthYear = '' + val\r\n    }\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    next(vm => {\r\n      const newId = vm.$route.query.id\r\n      const oldId = vm.firstForm.id\r\n      if (newId && newId !== oldId) {\r\n      // 说明是打开另一个单子的编辑页面\r\n        vm.firstForm.id = newId\r\n        vm.initDataById(newId)\r\n      } else if (!newId && oldId) {\r\n        // 说明是打开一个新建页面\r\n        // 将data数据初始成定义时的状态\r\n        Object.assign(vm.$data, vm.$options.data())\r\n        vm.$nextTick(() => {\r\n          vm.$refs.firstForm.resetFields()\r\n        })\r\n      }\r\n    })\r\n  },\r\n  methods: {\r\n    /**\r\n     * @description: 根据id获取数据\r\n     */\r\n    initDataById(id) {\r\n      getSocialResourceById({ id }).then(({ data }) => {\r\n        Object.keys(this.firstForm).forEach(key => {\r\n          this.firstForm[key] = data[key] || this.firstForm[key]\r\n        })\r\n        Object.assign(this.firstForm, {\r\n          fileList: data.upFile\r\n        })\r\n      })\r\n    },\r\n    /**\r\n     * 提交表单\r\n     */\r\n    submitForm() {\r\n      const req = {\r\n        ...this.firstForm\r\n      }\r\n      if (req.id) {\r\n        putSocialResource(req).then(res => {\r\n          this.$message.success('保存成功')\r\n          this.back()\r\n        })\r\n      } else {\r\n        addSocialResource(req).then(() => {\r\n          this.$message.success('提交成功')\r\n          this.back()\r\n        })\r\n      }\r\n    },\r\n    /**\r\n     * 返回上一页，并关闭当前页\r\n     */\r\n    back() {\r\n      this.utils.closeAndRefresh(this.$route.query.refreshRouterName)\r\n    }\r\n  }\r\n}\r\n",null]}